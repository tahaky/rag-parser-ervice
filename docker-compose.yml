version: '3.8'

services:
  # Parser Service
  parser-service:
    build: .
    depends_on:
      postgres:
        condition: service_healthy
      kafka:
        condition: service_healthy
      minio:
        condition: service_healthy
    environment:
      DATABASE_URL: postgresql://parser:parser@postgres:5432/parser_db
      KAFKA_BOOTSTRAP_SERVERS: kafka:9093
      MINIO_ENDPOINT: minio:9000
      MINIO_ACCESS_KEY: minioadmin
      MINIO_SECRET_KEY: minioadmin
      MINIO_BUCKET: documents
      MINIO_SECURE: "false"
      LOG_LEVEL: INFO
      WORKER_COUNT: 4
    ports:
      - "8080:8080"
    volumes:
      - ./temp:/tmp/parser

volumes:
  postgres_data:
  minio_data:
